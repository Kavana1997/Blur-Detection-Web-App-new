pipeline {
    agent any

    stages {
        stage('Checkout Code') {
            steps {
                git branch: 'main', url: 'https://github.com/Kavana1997/Blur-Detection-Web-App-new.git'
            }
        }

        stage('Install Dependencies') {
            steps {
                sh 'npm install'
            }
        }

        stage('Build Project') {
            steps {
                sh 'npm run build' // Replace with your build command
            }
        }

        stage('Unit Tests') {
            steps {
                sh 'npm test' // Replace with your unit test command
            }
        }

        stage('UI Tests (Optional)') {
            when {
                expression { branch == 'master' } // Run UI tests only on master branch
            }
            steps {
                sh 'npm run ui-test' // Replace with your UI test command
            }
        }

        stage('Code Quality Analysis (Optional)') {
            when {
                expression { branch == 'master' } // Run code quality analysis only on master branch
            }
            steps {
                sh 'sonar-scanner' // Replace with your SonarQube analysis command
            }
        }

        stage('Deploy (Optional)') {
            when {
                expression { branch == 'master' } // Deploy only on master branch
            }
            steps {
                // Replace with your deployment steps (e.g., using AWS CodeDeploy, Azure DevOps, manual steps)
                sh 'aws codedeploy deploy application-name MyBlurDetectionApp service-name MyBlurDetectionService'
            }
        }
    }
}
